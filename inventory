[all:vars]
ansible_ssh_user=pi
ansible_ssh_private_key_file=/ansible/secrets/id_rsa
ansible_python_interpreter=/usr/bin/python3
global_vault_address={{ lookup('env','VAULT_ADDR') }}
global_vault_token="hvs.am7PL4kntgFV1moTd8D9Cyfi"

[consul_instances]
raspberrypi.home consul_node_name=raspberrypi-1 consul_node_role=server

[consul_instances:vars]
consul_version=1.12.3
consul_architecture=arm
consul_dnsmasq_servers=["192.168.1.1"]

[vault_instances]
raspberrypi.home

[nomad_instances]
raspberrypi.home nomad_node_role=both nomad_node_name=rasperrypi-1

[nomad_instances:vars]
nomad_version=1.3.2
nomad_use_consul=true
nomad_vault_enabled=true
nomad_vault_token={{ lookup('env','VAULT_TOKEN') }}
nomad_vault_address=http://vault.service.consul:8200
nomad_raft_protocol=3
nomad_bootstrap_expect={{ groups['nomad_instances'] | length }}
nomad_vault_create_from_role="nomad-cluster"
nomad_consul_servers_service_name=nomad
nomad_bind_address=0.0.0.0
nomad_consul_address=127.0.0.1:8500
